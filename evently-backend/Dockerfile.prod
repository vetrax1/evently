# ---- Builder Stage ----
    FROM python:3.11-slim AS builder

    WORKDIR /app
    COPY requirements.txt .
    RUN pip install --no-cache-dir -r requirements.txt
    COPY . .
    RUN chmod +x run.py
    
    # ---- Final Stage ----
    FROM gcr.io/distroless/python3.11
    
    WORKDIR /app
    COPY --from=builder /app .
    
    # Use Distroless non-root user (UID 65532)
    USER nonroot
    
    EXPOSE 5000
    CMD ["./run.py"]